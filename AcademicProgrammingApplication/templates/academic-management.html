{% extends "layouts/base-app-pages.html" %}

{% load static %}
{% load my_filters %}

{% block tittle-container %}
Academic programming
{% endblock %}

{% block main-container-content %}
<div class="container">

    <div class="container text-center">
        <form method="GET">
            <div class="row g-2">
                <div class="col-md">
                    <div class="form-floating">
                        <input type="search" class="form-control" id="floatingInputGrid" placeholder="" name="program"
                               value="{{ request.GET.program }}">
                        <label for="floatingInputGrid">Buscar programa de posgrado</label>
                    </div>
                </div>
                <div class="col-md">
                    <div class="form-floating">
                        <select class="form-select" id="floatingSelectGrid" name="semester">
                            <option selected>2024-1</option>
                            <option value="2023-2">2023-2</option>
                            <option value="2023-1">2023-1</option>
                            <option value="2022-2">2022-2</option>
                        </select>
                        <label for="floatingSelectGrid">Periodo académico</label>
                    </div>
                    <script>
                        document.addEventListener("DOMContentLoaded", function () {
                            const select = document.getElementById("floatingSelectGrid");
                            const selectedOption = localStorage.getItem("selectedOption");
                            if (selectedOption) {
                                select.value = selectedOption;
                            }
                            select.addEventListener("change", function () {
                                localStorage.setItem("selectedOption", select.value);
                            });
                        });
                    </script>
                </div>
            </div>
        </form>
        <br>
        {% if program_information is not None %}
        <h3 class="text-lg-start">Información del POSGRADO</h3>
        <div class="container text-lg-start">
            <div class="row gx-5">
                <div class="col">
                    <div class="p-1">Nombre del programa:</div>
                </div>
                <div class="col">
                    <div class="p-1">{{ program_information.name }}</div>
                </div>
                <div class="col">
                    <div class="p-1">Tipo:</div>
                </div>
                <div class="col">
                    <div class="p-1">{{ program_information.type }}</div>
                </div>
            </div>
            <div class="row gx-5">
                <div class="col">
                    <div class="p-1">Facultad:</div>
                </div>
                <div class="col">
                    <div class="p-1">{{ program_information.faculty }}</div>
                </div>
                <div class="col">
                    <div class="p-1">Modalidad:</div>
                </div>
                <div class="col">
                    <div class="p-1">{{ program_information.modality }}</div>
                </div>
            </div>
            <div class="row gx-5">
                <div class="col">
                    <div class="p-1">Director de programa:</div>
                </div>
                <div class="col">
                    <div class="p-1">{{ program_information.director }}</div>
                </div>
                <div class="col">
                    <div class="p-1">Duración:</div>
                </div>
                <div class="col">
                    <div class="p-1">{{ program_information.duration }} semestres</div>
                </div>
            </div>
            <div class="row gx-5">
                <div class="col">
                    <div class="p-1">Costo de la matrícula:</div>
                </div>
                <div class="col">
                    <div class="p-1">$ {{ program_information.cost }}</div>
                </div>
                <div class="col">
                    <div class="p-1">Malla curricular:</div>
                </div>
                <div class="col">
                    <div class="p-1"><a href="{{ program_information.curriculum.url }}" download>
                        {{ program_information.curriculum.name|basename }}</a></div>
                </div>
            </div>
        </div>
        {% elif error is not None %}
        <div class="alert alert-primary" role="alert">
            {{ error }}
        </div>
        {% endif %}
    </div>
</div>
{% if program_information is not None %}

<div class="container">
    <div class="container">
        <br>
        <h3 class="text-lg-start">Información del semestre</h3>
        <div class="container overflow-hidden text-lg-start">
            <div class="p-1">Fechas del periodo académico:</div>
            <div class="row gx-5">
                <div class="col">
                    <div class="p-1">Inicio:</div>
                </div>
                <div class="col">
                    <div class="p-1">{{ semester.start_date }}</div>
                </div>
                <div class="col">
                    <div class="p-1">Fin:</div>
                </div>
                <div class="col">
                    <div class="p-1">{{ semester.ending_date }}</div>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <br>
        <h3 class="text-lg-start">Malla curricular</h3>
        <form method="GET">
            <input type="hidden" name="program" value="{{ request.GET.program }}">
            <input type="hidden" name="semester" value="{{ request.GET.semester }}">

            <div class="input-group">
                <input type="text" class="form-control" placeholder="Buscar materia del posgrado"
                       aria-label="Recipient's username with two button addons" name="subject_search">
                <button class="btn btn-outline-secondary" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
                        <path fill="currentColor"
                              d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5q0-2.725 1.888-4.612T9.5 3q2.725 0 4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5q0-1.875-1.312-3.187T9.5 5Q7.625 5 6.313 6.313T5 9.5q0 1.875 1.313 3.188T9.5 14"/>
                    </svg>
                </button>
            </div>
        </form>
        <br>
        {% if not subjects %}
        <div class="alert alert-secondary text-center" role="alert">
            No se encontraron asignaturas.
        </div>
        {% else %}
        <table class="table">
            <thead>
            <tr>
                <th scope="col">CÓDIGO</th>
                <th scope="col">MATERIA</th>
                <th scope="col">NRC</th>
                <th scope="col">CRÉDITOS</th>
                <th scope="col">TIPO</th>
                <th scope="col">SYLLABUS</th>
            </tr>
            </thead>
            <tbody>
            {% for subject in subjects %}
            <tr>
                <th scope="row">{{ subject.code }}</th>
                <td><a href="{% url 'subject_detail' subject.code %}"
                       class="link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover">
                    {{ subject.name }}</a></td>
                <td>{{ subject.nrc }}</td>
                <td>{{ subject.credits }}</td>
                <td>{{ subject.type }}</td>
                <td><a href="{{ subject.syllabus.url }}" download>{{ subject.syllabus.name|basename }}</a></td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
        {% endif %}
        <br>
    </div>
</div>
{% endif %}

{% endblock %}